---
title: "Proyecto TD 2024"
author: "Grupo C"
date: "2024-03-26"
output: html_document
---

**PROYECTO TD 2024**

Comenzamos introduciendo los datos que vamos a tratar:

Se nos establecen tickets electrónicos y en lugar de recibirlo en papel, los usuarios deberían poder obtenerlos vía documento pdf; tenemos una carpeta 'data'
en la que constan varios tickets, el objetivo incide en analizarlos para realizar un seguimiento: evolución precios, compras más habituales, productos más consumidos, supermercado habitual, hora de compra...

Vamos a importar los datos de dicha carpeta para su posterior análisis.

Primero establecemos liberías a utilizar:

Establecemos instalación automática de los paquetes:

```{r, message=FALSE} 
#(package manager) para gestionar la instalación de librerías. 
#message=FALSE no sale cuando se compila
# Asegúrate que el paquete "pacman" está instalado
if (!require("pacman")) install.packages("pacman")
if (!require("pdftools")) install.packages("pdftools") 
if (!require("pdfetch")) install.packages("pdfetch")

#Utilizamos la función `p_load` para la carga e instalación de paquetes

```

```{r}
p_load(ggplot2, knitr, tidyverse)
```

Procedemos con la lectura de los ficheros en la carpeta data.
Vamos a leer aquellos ficheros que contengan extensión .txt:

```{r}
#Archivos .txt de la carpeta 'data':
#Para ello hacemos uso de la función list.files()
#Estableceremos la carpeta y el patrón buscado
#para leer dichos ficheros (txt):
#full.names para ruta completa de archivos.
txt <- list.files("data", pattern = "\\.txt$", full.names = TRUE)

#Leemos ahora el contenido de uno:
tickets_txt <- lapply(txt, readLines)
tickets_txt
```
Pasamos a leer los ficheros con extensión pdf:

```{r}
pdf <- list.files("data", pattern = "\\.pdf$", full.names = TRUE)

#Necesitamos de una función que extraiga el texto
#almacenado en los ficheros pdf sin generar errores
#ya que al haber carácteres raros no los lee bien.
#Hacemos uso de la función pdf_text:

texto_pdf <- function(pdf) {
  texto <- pdf_text(pdf)
  return(texto)} 

#Hacemos lo mismo que en txt para leer dicha info.
tickets_pdf <- lapply(pdf, texto_pdf)
```

Vamos a convertir ambos en un dataframe para posteriormente combinarlos en uno solo:

```{r}
df1 <- data.frame(ticket = unlist(tickets_txt), tipo = "TXT")

df2 <- data.frame(ticket = unlist(tickets_pdf), tipo = "PDF")

df <- rbind(df1, df2)

head(df)
```






**PREGUNTAS PLANTEADAS CARA AL ANÁLISIS**

1. ¿Hay relación entre dos compras aleatorias en nuestra carpeta?

2. ¿Cuál es el promedio de gasto de los tickets?

3. ¿Producto más comprado en general?